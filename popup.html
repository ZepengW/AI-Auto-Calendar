<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>SJTU Auto Calendar</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        html, body, * { box-sizing: border-box; }
        body {
            font-family: system-ui, Segoe UI;
            min-width: 280px;
            max-width: 420px;
            margin: 0;
            padding: 14px;
            background: #f5f9ff;
            overflow-x: hidden;
        }

        h1 {
            font-size: 16px;
            margin: 0 0 10px 0
        }

        button {
            cursor: pointer;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 13px;
            font-weight: 600
        }

        button.primary {
            background: #0b74de;
            color: #fff
        }

        .row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap
        }
        /* No inline modal in popup; editing handled in options page */
    </style>
</head>

<body>
        <h1 style="font-size:15px;display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">SJTU Auto Calendar <button id="openOptions" style="background:#fff;border:1px solid #c5d3e2;font-size:12px;padding:4px 8px;border-radius:6px;cursor:pointer">设置</button></h1>
        <div style="display:flex;flex-direction:column;gap:12px">
            <section style="background:#fff;padding:10px;border:1px solid #dbe5f0;border-radius:10px;max-width:100%">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:13px;font-weight:600">定时任务</span>
                    <button id="addTask" style="background:#0b74de;color:#fff;font-size:12px;padding:4px 10px;border:none;border-radius:6px;cursor:pointer">新增</button>
                </div>
                <div id="tasksEmpty" style="font-size:12px;color:#666;display:none">暂无任务，点击“新增”创建。</div>
                <ul id="taskList" style="list-style:none;margin:0;padding:0;max-height:200px;overflow:auto;display:flex;flex-direction:column;gap:6px"></ul>
            </section>
            <section style="background:#fff;padding:10px;border:1px solid #dbe5f0;border-radius:10px;max-width:100%">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:13px;font-weight:600">非结构化日程解析</span>
                    <div style="display:flex;gap:6px;align-items:center">
                        <button id="parseLLMBtn" style="background:#0b74de;color:#fff;font-size:12px;padding:4px 10px;border:none;border-radius:6px;cursor:pointer">解析并上传</button>
                        <button id="parseLLMDownloadBtn" title="仅解析并下载ICS，不上传" style="background:#fff;border:1px solid #c5d3e2;color:#0b74de;font-size:12px;padding:4px 10px;border-radius:6px;cursor:pointer">解析并下载</button>
                    </div>
                </div>
                <textarea id="freeText" placeholder="粘贴待解析的自然语言日程..." style="width:100%;min-height:80px;resize:vertical;border:1px solid #c5d3e2;border-radius:6px;padding:6px;font-size:12px;font-family:system-ui"></textarea>
                <div id="freeTextStatus" style="font-size:11px;color:#666;margin-top:4px"></div>
            </section>
                    <section style="display:flex;gap:8px;max-width:100%">
                        <button id="openParsePage" style="flex:1;background:#fff;border:1px solid #c5d3e2;border-radius:8px;padding:8px 12px;font-weight:600;cursor:pointer">打开解析页面</button>
                    </section>
        </div>
        <div id="status" style="margin-top:10px;font-size:11px;color:#555"></div>
    <script src="src/popup.js" type="module"></script>
</body>

</html>